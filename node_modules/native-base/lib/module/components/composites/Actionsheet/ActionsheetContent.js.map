{"version":3,"sources":["ActionsheetContent.tsx"],"names":["React","memo","forwardRef","Modal","usePropsResolution","Animated","PanResponder","ModalContext","Box","ActionSheetContext","useHasResponsiveProps","Content","hideDragIndicator","children","handleClose","pan","sheetHeight","props","ref","_dragIndicator","_dragIndicatorWrapperOffSet","_dragIndicatorWrapper","resolvedProps","handleCloseRef","useRef","handleCloseCallback","useCallback","handleCloseCurrent","current","useEffect","panResponder","create","onStartShouldSetPanResponder","onMoveShouldSetPanResponder","_evt","gestureState","dy","onPanResponderMove","e","event","y","useNativeDriver","onPanResponderRelease","_e","timing","toValue","x","duration","start","setTimeout","spring","overshootClamping","panHandlers","ActionsheetContent","useContext","ValueXY","transform","translateY","width","height","nativeEvent","layout"],"mappings":";;AAAA,OAAOA,KAAP,IAAgBC,IAAhB,EAAsBC,UAAtB,QAAwC,OAAxC;AACA,SAASC,KAAT,QAAsB,wBAAtB;AAEA,SAASC,kBAAT,QAAmC,gBAAnC;AACA,SAASC,QAAT,EAAmBC,YAAnB,QAAuC,cAAvC;AACA,SAASC,YAAT,QAA6B,kBAA7B;AACA,OAAOC,GAAP,MAAgB,sBAAhB;AACA,SAASC,kBAAT,QAAmC,sBAAnC;AACA,SAASC,qBAAT,QAAsC,sCAAtC;AAEA,MAAMC,OAAO,gBAAGV,IAAI,eAClBC,UAAU,CACR,CACE;AACEU,EAAAA,iBADF;AAEEC,EAAAA,QAFF;AAGEC,EAAAA,WAHF;AAIEC,EAAAA,GAJF;AAKEC,EAAAA,WALF;AAME,KAAGC;AANL,CADF,EASEC,GATF,KAUK;AACH,QAAM;AACJC,IAAAA,cADI;AAEJC,IAAAA,2BAFI;AAGJC,IAAAA,qBAHI;AAIJ,OAAGC;AAJC,MAKFlB,kBAAkB,CAAC,oBAAD,EAAuBa,KAAvB,CALtB;AAOA,QAAMM,cAAc,GAAGvB,KAAK,CAACwB,MAAN,CAAa,IAAb,CAAvB;AACA,QAAMC,mBAAmB,GAAGzB,KAAK,CAAC0B,WAAN,CAAkB,MAAM;AAClD,QAAIC,kBAAkB,GAAGJ,cAAc,CAACK,OAAxC,CADkD,CAElD;;AACA,WAAOD,kBAAkB,EAAzB;AACD,GAJ2B,EAIzB,EAJyB,CAA5B;AAKA3B,EAAAA,KAAK,CAAC6B,SAAN,CAAgB,MAAM;AACpBN,IAAAA,cAAc,CAACK,OAAf,GAAyBd,WAAzB;AACD,GAFD,EAEG,CAACA,WAAD,CAFH;AAIA,QAAMgB,YAAY,GAAG9B,KAAK,CAACwB,MAAN,CACnBlB,YAAY,CAACyB,MAAb,CAAoB;AAClBC,IAAAA,4BAA4B,EAAE,MAAM,IADlB;AAElBC,IAAAA,2BAA2B,EAAE,CAACC,IAAD,EAAOC,YAAP,KAAwB;AACnD,aAAOA,YAAY,CAACC,EAAb,GAAkB,EAAzB;AACD,KAJiB;AAKlBC,IAAAA,kBAAkB,EAAE,CAACC,CAAD,EAAIH,YAAJ,KAAqB;AACvC,UAAIA,YAAY,CAACC,EAAb,GAAkB,CAAtB,EAAyB;AACvB/B,QAAAA,QAAQ,CAACkC,KAAT,CAAe,CAAC,IAAD,EAAO;AAAEH,UAAAA,EAAE,EAAErB,GAAG,CAACyB;AAAV,SAAP,CAAf,EAAsC;AACpCC,UAAAA,eAAe,EAAE;AADmB,SAAtC,EAEGH,CAFH,EAEMH,YAFN;AAGD;AACF,KAXiB;AAYlBO,IAAAA,qBAAqB,EAAE,CAACC,EAAD,EAAKR,YAAL,KAAsB;AAC3C;AACA,UAAInB,WAAW,CAACY,OAAZ,GAAsB,CAAtB,GAA0BO,YAAY,CAACC,EAAvC,GAA4C,CAAhD,EAAmD;AACjD/B,QAAAA,QAAQ,CAACuC,MAAT,CAAgB7B,GAAhB,EAAqB;AACnB8B,UAAAA,OAAO,EAAE;AAAEC,YAAAA,CAAC,EAAE,CAAL;AAAQN,YAAAA,CAAC,EAAExB,WAAW,CAACY;AAAvB,WADU;AAEnBmB,UAAAA,QAAQ,EAAE,GAFS;AAGnBN,UAAAA,eAAe,EAAE;AAHE,SAArB,EAIGO,KAJH,CAISvB,mBAJT;AAMAwB,QAAAA,UAAU,CAAC,MAAM;AACf5C,UAAAA,QAAQ,CAACuC,MAAT,CAAgB7B,GAAhB,EAAqB;AACnB8B,YAAAA,OAAO,EAAE;AAAEC,cAAAA,CAAC,EAAE,CAAL;AAAQN,cAAAA,CAAC,EAAE;AAAX,aADU;AAEnBO,YAAAA,QAAQ,EAAE,GAFS;AAGnBN,YAAAA,eAAe,EAAE;AAHE,WAArB,EAIGO,KAJH;AAKD,SANS,EAMP,GANO,CAAV;AAOD,OAdD,MAcO;AACL3C,QAAAA,QAAQ,CAAC6C,MAAT,CAAgBnC,GAAhB,EAAqB;AACnB8B,UAAAA,OAAO,EAAE;AAAEC,YAAAA,CAAC,EAAE,CAAL;AAAQN,YAAAA,CAAC,EAAE;AAAX,WADU;AAEnBW,UAAAA,iBAAiB,EAAE,IAFA;AAGnBV,UAAAA,eAAe,EAAE;AAHE,SAArB,EAIGO,KAJH;AAKD;AACF;AAnCiB,GAApB,CADmB,EAsCnBpB,OAtCF;AAwCA,sBACE,0CACG,CAAChB,iBAAD,gBACC,uDAEE,oBAAC,GAAD,eACMkB,YAAY,CAACsB,WADnB,EAEMhC,2BAFN,EAFF,CADD,GAQG,IATN,eAWE,oBAAC,KAAD,CAAO,OAAP,eAAmBE,aAAnB;AAAkC,IAAA,GAAG,EAAEJ,GAAvC;AAA4C,IAAA,cAAc;AAA1D,MACG,CAACN,iBAAD,gBACC,uDAEE,oBAAC,GAAD,eAASkB,YAAY,CAACsB,WAAtB,EAAuC/B,qBAAvC,gBACE,oBAAC,GAAD,EAASF,cAAT,CADF,CAFF,CADD,GAOG,IARN,EAUGN,QAVH,CAXF,CADF;AA0BD,CA/FO,CADQ,CAApB;;AAmGA,MAAMwC,kBAAkB,GAAG,CACzB;AAAExC,EAAAA,QAAF;AAAY,KAAGI;AAAf,CADyB,EAEzBC,GAFyB,KAGtB;AACH;AACA,QAAM;AAAEJ,IAAAA;AAAF,MAAkBd,KAAK,CAACsD,UAAN,CAAiB/C,YAAjB,CAAxB;AACA,QAAM;AAAEK,IAAAA;AAAF,MAAwBZ,KAAK,CAACsD,UAAN,CAAiB7C,kBAAjB,CAA9B;AACA,QAAMM,GAAG,GAAGf,KAAK,CAACwB,MAAN,CAAa,IAAInB,QAAQ,CAACkD,OAAb,EAAb,EAAqC3B,OAAjD;AACA,QAAMZ,WAAW,GAAGhB,KAAK,CAACwB,MAAN,CAAa,CAAb,CAApB;AAEA,QAAMC,mBAAmB,GAAGzB,KAAK,CAAC0B,WAAN,CAAkBZ,WAAlB,EAA+B,CACzDP,YADyD,EAEzDO,WAFyD,CAA/B,CAA5B,CAPG,CAYH;AAEA;AAEA;;AACA,MAAIJ,qBAAqB,CAACO,KAAD,CAAzB,EAAkC;AAChC,WAAO,IAAP;AACD;;AAED,sBACE,oBAAC,QAAD,CAAU,IAAV;AACE,IAAA,KAAK,EAAE;AACLuC,MAAAA,SAAS,EAAE,CAAC;AAAEC,QAAAA,UAAU,EAAE1C,GAAG,CAACyB;AAAlB,OAAD,CADN;AAELkB,MAAAA,KAAK,EAAE;AAFF,KADT;AAKE,IAAA,QAAQ,EAAGnB,KAAD,IAAW;AACnB,YAAM;AAAEoB,QAAAA;AAAF,UAAapB,KAAK,CAACqB,WAAN,CAAkBC,MAArC;AACA7C,MAAAA,WAAW,CAACY,OAAZ,GAAsB+B,MAAtB;AACD,KARH;AASE,IAAA,aAAa,EAAC;AAThB,kBAWE,oBAAC,OAAD;AACE,IAAA,QAAQ,EAAE9C,QADZ;AAEE,IAAA,WAAW,EAAEG,WAFf;AAGE,IAAA,GAAG,EAAED,GAHP;AAIE,IAAA,iBAAiB,EAAEH,iBAJrB;AAKE,IAAA,WAAW,EAAEa,mBALf;AAME,IAAA,GAAG,EAAEP;AANP,KAOMD,KAPN,EAXF,CADF;AAuBD,CA/CD;;AAiDA,4BAAehB,IAAI,eAACC,UAAU,CAACmD,kBAAD,CAAX,CAAnB","sourcesContent":["import React, { memo, forwardRef } from 'react';\nimport { Modal } from '../../composites/Modal';\nimport type { IActionsheetContentProps } from './types';\nimport { usePropsResolution } from '../../../hooks';\nimport { Animated, PanResponder } from 'react-native';\nimport { ModalContext } from '../Modal/Context';\nimport Box from '../../primitives/Box';\nimport { ActionSheetContext } from './ActionSheetContext';\nimport { useHasResponsiveProps } from '../../../hooks/useHasResponsiveProps';\n\nconst Content = memo(\n  forwardRef(\n    (\n      {\n        hideDragIndicator,\n        children,\n        handleClose,\n        pan,\n        sheetHeight,\n        ...props\n      }: any,\n      ref: any\n    ) => {\n      const {\n        _dragIndicator,\n        _dragIndicatorWrapperOffSet,\n        _dragIndicatorWrapper,\n        ...resolvedProps\n      } = usePropsResolution('ActionsheetContent', props);\n\n      const handleCloseRef = React.useRef(null);\n      const handleCloseCallback = React.useCallback(() => {\n        let handleCloseCurrent = handleCloseRef.current;\n        //@ts-ignore\n        return handleCloseCurrent();\n      }, []);\n      React.useEffect(() => {\n        handleCloseRef.current = handleClose;\n      }, [handleClose]);\n\n      const panResponder = React.useRef(\n        PanResponder.create({\n          onStartShouldSetPanResponder: () => true,\n          onMoveShouldSetPanResponder: (_evt, gestureState) => {\n            return gestureState.dy > 15;\n          },\n          onPanResponderMove: (e, gestureState) => {\n            if (gestureState.dy > 0) {\n              Animated.event([null, { dy: pan.y }], {\n                useNativeDriver: false,\n              })(e, gestureState);\n            }\n          },\n          onPanResponderRelease: (_e, gestureState) => {\n            // If sheet is dragged 1/4th of it's height, close it\n            if (sheetHeight.current / 4 - gestureState.dy < 0) {\n              Animated.timing(pan, {\n                toValue: { x: 0, y: sheetHeight.current },\n                duration: 150,\n                useNativeDriver: true,\n              }).start(handleCloseCallback);\n\n              setTimeout(() => {\n                Animated.timing(pan, {\n                  toValue: { x: 0, y: 0 },\n                  duration: 150,\n                  useNativeDriver: true,\n                }).start();\n              }, 300);\n            } else {\n              Animated.spring(pan, {\n                toValue: { x: 0, y: 0 },\n                overshootClamping: true,\n                useNativeDriver: true,\n              }).start();\n            }\n          },\n        })\n      ).current;\n\n      return (\n        <>\n          {!hideDragIndicator ? (\n            <>\n              {/* To increase the draggable area */}\n              <Box\n                {...panResponder.panHandlers}\n                {..._dragIndicatorWrapperOffSet}\n              />\n            </>\n          ) : null}\n\n          <Modal.Content {...resolvedProps} ref={ref} safeAreaBottom>\n            {!hideDragIndicator ? (\n              <>\n                {/* Hack. Fix later. Add -2 negative margin to remove the padding added by ActionSheetContent */}\n                <Box {...panResponder.panHandlers} {..._dragIndicatorWrapper}>\n                  <Box {..._dragIndicator} />\n                </Box>\n              </>\n            ) : null}\n\n            {children}\n          </Modal.Content>\n        </>\n      );\n    }\n  )\n);\nconst ActionsheetContent = (\n  { children, ...props }: IActionsheetContentProps,\n  ref?: any\n) => {\n  // return null;\n  const { handleClose } = React.useContext(ModalContext);\n  const { hideDragIndicator } = React.useContext(ActionSheetContext);\n  const pan = React.useRef(new Animated.ValueXY()).current;\n  const sheetHeight = React.useRef(0);\n\n  const handleCloseCallback = React.useCallback(handleClose, [\n    ModalContext,\n    handleClose,\n  ]);\n\n  // useEffect(() => {\n\n  // }, [])\n\n  //TODO: refactor for responsive prop\n  if (useHasResponsiveProps(props)) {\n    return null;\n  }\n\n  return (\n    <Animated.View\n      style={{\n        transform: [{ translateY: pan.y }],\n        width: '100%',\n      }}\n      onLayout={(event) => {\n        const { height } = event.nativeEvent.layout;\n        sheetHeight.current = height;\n      }}\n      pointerEvents=\"box-none\"\n    >\n      <Content\n        children={children}\n        sheetHeight={sheetHeight}\n        pan={pan}\n        hideDragIndicator={hideDragIndicator}\n        handleClose={handleCloseCallback}\n        ref={ref}\n        {...props}\n      />\n    </Animated.View>\n  );\n};\n\nexport default memo(forwardRef(ActionsheetContent));\n"]}